var e,t,n,r,i,o,l,a,s,_,c,u,d,f,h,p,g,m={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,b=Array.isArray;function w(e,t){for(var n in t)e[n]=t[n];return e}function k(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function E(e,t,n,r,i){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==i?++s:i,__i:-1,__u:0};return null==i&&null!=a.vnode&&a.vnode(o),o}function C(e){return e.children}function A(e,t){this.props=e,this.context=t}function S(e,t){if(null==t)return e.__?S(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?S(e):null}function N(e){(!e.__d&&(e.__d=!0)&&_.push(e)&&!T.__r++||c!=a.debounceRendering)&&((c=a.debounceRendering)||u)(T)}function T(){for(var e,t,n,r,i,o,l=1;_.length;)_.length>l&&_.sort(d),e=_.shift(),l=_.length,e.__d&&(t=void 0,r=(n=e.__v).__e,i=[],o=[],e.__P&&((t=w({},n)).__v=n.__v+1,a.vnode&&a.vnode(t),R(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[r]:null,i,null==r?S(n):r,!!(32&n.__u),o),t.__v=n.__v,t.__.__k[t.__i]=t,D(i,t,o),t.__e!=r&&function e(t){var n,r;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,n=0;n<t.__k.length;n++)if(null!=(r=t.__k[n])&&null!=r.__e){t.__e=t.__c.base=r.__e;break}return e(t)}}(t)));T.__r=0}function P(e,t,n,r,i,o,l,s,_,c,u){var d,f,h,p,g,y,w=r&&r.__k||v,A=t.length;for(_=function(e,t,n,r,i){var o,l,s,_,c,u=n.length,d=u,f=0;for(e.__k=Array(i),o=0;o<i;o++)null!=(l=t[o])&&"boolean"!=typeof l&&"function"!=typeof l?(_=o+f,(l=e.__k[o]="string"==typeof l||"number"==typeof l||"bigint"==typeof l||l.constructor==String?E(null,l,null,null,null):b(l)?E(C,{children:l},null,null,null):null==l.constructor&&l.__b>0?E(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):l).__=e,l.__b=e.__b+1,s=null,-1!=(c=l.__i=function(e,t,n,r){var i,o,l=e.key,a=e.type,s=t[n];if(null===s&&null==e.key||s&&l==s.key&&a==s.type&&0==(2&s.__u))return n;if(r>+(null!=s&&0==(2&s.__u)))for(i=n-1,o=n+1;i>=0||o<t.length;){if(i>=0){if((s=t[i])&&0==(2&s.__u)&&l==s.key&&a==s.type)return i;i--}if(o<t.length){if((s=t[o])&&0==(2&s.__u)&&l==s.key&&a==s.type)return o;o++}}return -1}(l,n,_,d))&&(d--,(s=n[c])&&(s.__u|=2)),null==s||null==s.__v?(-1==c&&(i>u?f--:i<u&&f++),"function"!=typeof l.type&&(l.__u|=4)):c!=_&&(c==_-1?f--:c==_+1?f++:(c>_?f--:f++,l.__u|=4))):e.__k[o]=null;if(d)for(o=0;o<u;o++)null!=(s=n[o])&&0==(2&s.__u)&&(s.__e==r&&(r=S(s)),function e(t,n,r){var i,o;if(a.unmount&&a.unmount(t),(i=t.ref)&&(i.current&&i.current!=t.__e||H(i,null,n)),null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(e){a.__e(e,n)}i.base=i.__P=null}if(i=t.__k)for(o=0;o<i.length;o++)i[o]&&e(i[o],n,r||"function"!=typeof t.type);r||k(t.__e),t.__c=t.__=t.__e=void 0}(s,s));return r}(n,t,w,_,A),d=0;d<A;d++)null!=(h=n.__k[d])&&(f=-1==h.__i?m:w[h.__i]||m,h.__i=d,y=R(e,h,f,i,o,l,s,_,c,u),p=h.__e,h.ref&&f.ref!=h.ref&&(f.ref&&H(f.ref,null,h),u.push(h.ref,h.__c||p,h)),null==g&&null!=p&&(g=p),4&h.__u||f.__k===h.__k?_=function e(t,n,r){var i,o;if("function"==typeof t.type){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,n=e(i[o],n,r));return n}t.__e!=n&&(n&&t.type&&!r.contains(n)&&(n=S(t)),r.insertBefore(t.__e,n||null),n=t.__e);do n=n&&n.nextSibling;while(null!=n&&8==n.nodeType)return n}(h,_,e):"function"==typeof h.type&&void 0!==y?_=y:p&&(_=p.nextSibling),h.__u&=-7);return n.__e=g,_}function x(e,t,n){"-"==t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||y.test(t)?n:n+"px"}function $(e,t,n,r,i){var o;e:if("style"==t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||x(e.style,t,"");if(n)for(t in n)r&&n[t]==r[t]||x(e.style,t,n[t])}else if("o"==t[0]&&"n"==t[1])o=t!=(t=t.replace(f,"$1")),t=t.toLowerCase()in e||"onFocusOut"==t||"onFocusIn"==t?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r?n.u=r.u:(n.u=h,e.addEventListener(t,o?g:p,o)):e.removeEventListener(t,o?g:p,o);else{if("http://www.w3.org/2000/svg"==i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==n?"":n))}}function O(e){return function(t){if(this.l){var n=this.l[t.type+e];if(null==t.t)t.t=h++;else if(t.t<n.u)return;return n(a.event?a.event(t):t)}}}function R(e,t,n,r,i,o,s,_,c,u){var d,f,h,p,g,v,y,E,N,T,x,O,R,D,H,F,U,I=t.type;if(null!=t.constructor)return null;128&n.__u&&(c=!!(32&n.__u),o=[_=t.__e=n.__e]),(d=a.__b)&&d(t);e:if("function"==typeof I)try{if(E=t.props,N="prototype"in I&&I.prototype.render,T=(d=I.contextType)&&r[d.__c],x=d?T?T.props.value:d.__:r,n.__c?y=(f=t.__c=n.__c).__=f.__E:(N?t.__c=f=new I(E,x):(t.__c=f=new A(E,x),f.constructor=I,f.render=L),T&&T.sub(f),f.props=E,f.state||(f.state={}),f.context=x,f.__n=r,h=f.__d=!0,f.__h=[],f._sb=[]),N&&null==f.__s&&(f.__s=f.state),N&&null!=I.getDerivedStateFromProps&&(f.__s==f.state&&(f.__s=w({},f.__s)),w(f.__s,I.getDerivedStateFromProps(E,f.__s))),p=f.props,g=f.state,f.__v=t,h)N&&null==I.getDerivedStateFromProps&&null!=f.componentWillMount&&f.componentWillMount(),N&&null!=f.componentDidMount&&f.__h.push(f.componentDidMount);else{if(N&&null==I.getDerivedStateFromProps&&E!==p&&null!=f.componentWillReceiveProps&&f.componentWillReceiveProps(E,x),!f.__e&&null!=f.shouldComponentUpdate&&!1===f.shouldComponentUpdate(E,f.__s,x)||t.__v==n.__v){for(t.__v!=n.__v&&(f.props=E,f.state=f.__s,f.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(e){e&&(e.__=t)}),O=0;O<f._sb.length;O++)f.__h.push(f._sb[O]);f._sb=[],f.__h.length&&s.push(f);break e}null!=f.componentWillUpdate&&f.componentWillUpdate(E,f.__s,x),N&&null!=f.componentDidUpdate&&f.__h.push(function(){f.componentDidUpdate(p,g,v)})}if(f.context=x,f.props=E,f.__P=e,f.__e=!1,R=a.__r,D=0,N){for(f.state=f.__s,f.__d=!1,R&&R(t),d=f.render(f.props,f.state,f.context),H=0;H<f._sb.length;H++)f.__h.push(f._sb[H]);f._sb=[]}else do f.__d=!1,R&&R(t),d=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++D<25)f.state=f.__s,null!=f.getChildContext&&(r=w(w({},r),f.getChildContext())),N&&!h&&null!=f.getSnapshotBeforeUpdate&&(v=f.getSnapshotBeforeUpdate(p,g)),F=d,null!=d&&d.type===C&&null==d.key&&(F=function e(t){return"object"!=typeof t||null==t||t.__b&&t.__b>0?t:b(t)?t.map(e):w({},t)}(d.props.children)),_=P(e,b(F)?F:[F],t,n,r,i,o,s,_,c,u),f.base=t.__e,t.__u&=-161,f.__h.length&&s.push(f),y&&(f.__E=f.__=null)}catch(e){if(t.__v=null,c||null!=o)if(e.then){for(t.__u|=c?160:128;_&&8==_.nodeType&&_.nextSibling;)_=_.nextSibling;o[o.indexOf(_)]=null,t.__e=_}else for(U=o.length;U--;)k(o[U]);else t.__e=n.__e,t.__k=n.__k;a.__e(e,t,n)}else null==o&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):_=t.__e=function(e,t,n,r,i,o,s,_,c){var u,d,f,h,p,g,v,y=n.props,w=t.props,E=t.type;if("svg"==E?i="http://www.w3.org/2000/svg":"math"==E?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),null!=o){for(u=0;u<o.length;u++)if((p=o[u])&&"setAttribute"in p==!!E&&(E?p.localName==E:3==p.nodeType)){e=p,o[u]=null;break}}if(null==e){if(null==E)return document.createTextNode(w);e=document.createElementNS(i,E,w.is&&w),_&&(a.__m&&a.__m(t,o),_=!1),o=null}if(null==E)y===w||_&&e.data==w||(e.data=w);else{if(o=o&&l.call(e.childNodes),y=n.props||m,!_&&null!=o)for(y={},u=0;u<e.attributes.length;u++)y[(p=e.attributes[u]).name]=p.value;for(u in y)if(p=y[u],"children"==u);else if("dangerouslySetInnerHTML"==u)f=p;else if(!(u in w)){if("value"==u&&"defaultValue"in w||"checked"==u&&"defaultChecked"in w)continue;$(e,u,null,p,i)}for(u in w)p=w[u],"children"==u?h=p:"dangerouslySetInnerHTML"==u?d=p:"value"==u?g=p:"checked"==u?v=p:_&&"function"!=typeof p||y[u]===p||$(e,u,p,y[u],i);if(d)_||f&&(d.__html==f.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(f&&(e.innerHTML=""),P("template"==t.type?e.content:e,b(h)?h:[h],t,n,r,"foreignObject"==E?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:n.__k&&S(n,0),_,c),null!=o)for(u=o.length;u--;)k(o[u]);_||(u="value","progress"==E&&null==g?e.removeAttribute("value"):null==g||g===e[u]&&("progress"!=E||g)&&("option"!=E||g==y[u])||$(e,u,g,y[u],i),u="checked",null!=v&&v!=e[u]&&$(e,u,v,y[u],i))}return e}(n.__e,t,n,r,i,o,s,c,u);return(d=a.diffed)&&d(t),128&t.__u?void 0:_}function D(e,t,n){for(var r=0;r<n.length;r++)H(n[r],n[++r],n[++r]);a.__c&&a.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){a.__e(e,t.__v)}})}function H(e,t,n){try{if("function"==typeof e){var r="function"==typeof e.__u;r&&e.__u(),r&&null==t||(e.__u=e(t))}else e.current=t}catch(e){a.__e(e,n)}}function L(e,t,n){return this.constructor(e,n)}l=v.slice,a={__e:function(e,t,n,r){for(var i,o,l;t=t.__;)if((i=t.__c)&&!i.__)try{if((o=i.constructor)&&null!=o.getDerivedStateFromError&&(i.setState(o.getDerivedStateFromError(e)),l=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),l=i.__d),l)return i.__E=i}catch(t){e=t}throw e}},s=0,A.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=w({},this.state),"function"==typeof e&&(e=e(w({},n),this.props)),e&&w(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),N(this))},A.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),N(this))},A.prototype.render=C,_=[],u="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,d=function(e,t){return e.__v.__b-t.__v.__b},T.__r=0,f=/(PointerCapture)$|Capture$/i,h=0,p=O(!1),g=O(!0);var F=0;function U(e,t,n,r,i,o){t||(t={});var l,s,_=t;if("ref"in _)for(s in _={},t)"ref"==s?l=t[s]:_[s]=t[s];var c={type:e,props:_,key:n,ref:l,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--F,__i:-1,__u:0,__source:i,__self:o};if("function"==typeof e&&(l=e.defaultProps))for(s in l)void 0===_[s]&&(_[s]=l[s]);return a.vnode&&a.vnode(c),c}var I,W,M,j,J=0,B=[],q=a,G=q.__b,V=q.__r,z=q.diffed,K=q.__c,Q=q.unmount,Y=q.__;function Z(e,t){q.__h&&q.__h(W,e,J||t),J=0;var n=W.__H||(W.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function X(e){return J=1,function(e,t,n){var r=Z(I++,2);if(r.t=e,!r.__c&&(r.__=[e_(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],n=r.t(t,e);t!==n&&(r.__N=[n,r.__[1]],r.__c.setState({}))}],r.__c=W,!W.__f)){var i=function(e,t,n){if(!r.__c.__H)return!0;var i=r.__c.__H.__.filter(function(e){return!!e.__c});if(i.every(function(e){return!e.__N}))return!o||o.call(this,e,t,n);var l=r.__c.props!==e;return i.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(l=!0)}}),o&&o.call(this,e,t,n)||l};W.__f=!0;var o=W.shouldComponentUpdate,l=W.componentWillUpdate;W.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,i(e,t,n),o=r}l&&l.call(this,e,t,n)},W.shouldComponentUpdate=i}return r.__N||r.__}(e_,e)}function ee(e,t){var n=Z(I++,3);!q.__s&&es(n.__H,t)&&(n.__=e,n.u=t,W.__H.__h.push(n))}function et(e){return J=5,en(function(){return{current:e}},[])}function en(e,t){var n=Z(I++,7);return es(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function er(e,t){return J=8,en(function(){return e},t)}function ei(){for(var e;e=B.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(el),e.__H.__h.forEach(ea),e.__H.__h=[]}catch(t){e.__H.__h=[],q.__e(t,e.__v)}}q.__b=function(e){W=null,G&&G(e)},q.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Y&&Y(e,t)},q.__r=function(e){V&&V(e),I=0;var t=(W=e.__c).__H;t&&(M===W?(t.__h=[],W.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(el),t.__h.forEach(ea),t.__h=[],I=0)),M=W},q.diffed=function(e){z&&z(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==B.push(t)&&j===q.requestAnimationFrame||((j=q.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),eo&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);eo&&(t=requestAnimationFrame(n))})(ei)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),M=W=null},q.__c=function(e,t){t.some(function(e){try{e.__h.forEach(el),e.__h=e.__h.filter(function(e){return!e.__||ea(e)})}catch(n){t.some(function(e){e.__h&&(e.__h=[])}),t=[],q.__e(n,e.__v)}}),K&&K(e,t)},q.unmount=function(e){Q&&Q(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(e){try{el(e)}catch(e){t=e}}),n.__H=void 0,t&&q.__e(t,n.__v))};var eo="function"==typeof requestAnimationFrame;function el(e){var t=W,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),W=t}function ea(e){var t=W;e.__c=e.__(),W=t}function es(e,t){return!e||e.length!==t.length||t.some(function(t,n){return t!==e[n]})}function e_(e,t){return"function"==typeof t?t(e):t}const ec="#/tabs/";function eu({tabs:e}){let t=er(()=>{if("undefined"==typeof window)return null;let t=window.location.hash;if(t.startsWith(ec)){let n=t.substring(ec.length);return e.find(e=>e.id===n)?n:null}return null},[e]),[n,r]=X(()=>{let n=t();return n||(e&&e.length>0?e[0].id:"")});ee(()=>{let i=()=>{let i=t();i?i!==n&&r(i):e&&e.length>0&&n!==e[0].id&&r(e[0].id)};return"undefined"!=typeof window&&window.addEventListener("hashchange",i),()=>{"undefined"!=typeof window&&window.removeEventListener("hashchange",i)}},[e,n,t]),ee(()=>{if("undefined"!=typeof window)if(e&&e.length>0){let t=e.some(e=>e.id===n),i=n;if(!t&&n!==(i=e[0].id))return void r(i);let o=`${ec}${i}`;window.location.hash!==o&&(window.location.hash=o)}else""!==n&&r(""),window.location.hash.startsWith(ec)&&window.location.hash!==ec&&(window.location.hash="")},[n,e]);let i=e=>{e!==n&&r(e)};if(!e||0===e.length)return U("p",{children:"No tabs to display."});let o=e.find(e=>e.id===n)?.content;return U("div",{children:[U("div",{class:"tabs",children:e.map(e=>U("button",{type:"button",class:`tab-button ${e.id===n?"active":""}`,onClick:()=>i(e.id),children:e.name},e.id))}),U("div",{class:"tab-content-area",children:o})]})}function ed(){let[e,t]=X(null),[n,r]=X(null),[i,o]=X(null),[l,a]=X("Untested");return(ee(()=>{fetch("/api/status").then(e=>e.ok?e.json():Promise.reject(Error(`Failed to fetch status: ${e.status} ${e.statusText}`))).then(e=>t(e)).catch(e=>{console.error("Error fetching status:",e),o(t=>t?`${t}
Error fetching status: ${e.message}`:`Error fetching status: ${e.message}`)}),fetch("/api/config").then(e=>e.ok?e.json():Promise.reject(Error(`Failed to fetch config: ${e.status} ${e.statusText}`))).then(e=>r(e)).catch(e=>{console.error("Error fetching current config:",e),o(t=>t?`${t}
Error fetching current config: ${e.message}`:`Error fetching current config: ${e.message}`)}),a("Testing..."),fetch("/api/test-openai").then(e=>e.ok?e.json():e.json().then(t=>{throw Error(t.message||`API error: ${e.status} ${e.statusText}`)}).catch(()=>{throw Error(`API error: ${e.status} ${e.statusText} (No JSON body)`)})).then(e=>{e.isValid?a("Valid"):a("Invalid")}).catch(e=>{console.error("Error testing OpenAI key:",e),a("Error")})},[]),i)?U("pre",{children:["Error loading data for this tab: ",i]}):U("div",{class:"tab-content-item",children:[U("section",{id:"status-section",children:[U("h2",{children:"Gateway Status"}),e?U("div",{children:[U("ul",{children:[U("li",{children:[U("strong",{children:"Status:"})," ",e.status||"N/A"]}),U("li",{children:[U("strong",{children:"Uptime:"})," ",e.uptime?.toFixed(2)||"N/A","s"]}),U("li",{children:[U("strong",{children:"OpenAI Key:"})," ",U("span",{class:`status-${l.toLowerCase().replace(/\.\.\./,"")}`,children:l})]})]}),U("h3",{children:"Backends:"}),e.backends&&e.backends.length>0?U("ul",{children:e.backends.map(e=>U("li",{children:[U("strong",{children:[e.displayName||e.id,":"]}),U("span",{class:e.isReady?"status-ready":"status-not-ready",children:e.isReady?"Ready":"Not Ready"})]},e.id))}):U("p",{children:"No backends configured or status unavailable."})]}):U("p",{children:"Loading status..."})]}),U("section",{id:"current-config-section",children:[U("h2",{children:"Current Effective Configuration"}),n?U("pre",{children:JSON.stringify(n,null,2)}):U("p",{children:"Loading current configuration..."})]})]})}const ef=(e,t)=>U("div",{children:[U("h3",{children:e}),t?U("pre",{children:JSON.stringify(t,null,2)}):U("pre",{children:JSON.stringify({note:"Data not available or not yet set."},null,2)})]});function eh(){let[e,t]=X(null),[n,r]=X(null);return(ee(()=>{fetch("/api/config-details").then(e=>e.ok?e.json():Promise.reject(Error(`Failed to fetch config details: ${e.status} ${e.statusText}`))).then(e=>t(e)).catch(e=>{console.error("Error fetching config details:",e),r(`Error fetching config details: ${e.message}`)})},[]),n)?U("pre",{children:["Error: ",n]}):e?U("div",{class:"tab-content-item",children:U("section",{children:[U("h2",{children:"Configuration States"}),ef("Initial Environment/Default Config (Pre-MCP Handshake):",e.initialEnvConfig),ef("Client-Sent `initializationOptions` (Raw from client):",e.clientSentInitOptions),ef("Final Effective Config (Post-MCP Handshake):",e.finalEffectiveConfig)]})}):U("p",{children:"Loading configuration details..."})}const ep={TRACE:10,DEBUG:20,INFO:30,WARN:40,ERROR:50,FATAL:60};function eg(){let[e,t]=X([]),[n,r]=X("INFO"),[i,o]=X(!0),[l,a]=X(!1),s=et(null),_=et(null),c=er(()=>{_.current&&_.current.readyState<WebSocket.CLOSING&&_.current.close();let e=new WebSocket(`ws://${window.location.host}`);_.current=e,e.onopen=()=>{console.log("Logs WebSocket connected"),a(!0),t(e=>[{timestamp:Date.now(),level:"INFO",message:"Connected to real-time logs...",details:{}},...e.slice(0,199)])},e.onmessage=e=>{try{let r=JSON.parse(e.data);if("log_entry"===r.type){let e=r.payload;t(t=>"all"!==n&&ep[e.level]<ep[n]?t:[e,...t].slice(0,200))}}catch(n){console.error("Error processing log message:",n,e.data),t(t=>[{timestamp:Date.now(),level:"ERROR",message:`Error processing ws message: ${e.data}`,details:{error:n.message}},...t.slice(0,199)])}},e.onclose=()=>{console.log("Logs WebSocket disconnected"),a(!1),t(e=>[{timestamp:Date.now(),level:"WARN",message:"Log WebSocket disconnected. Attempting to reconnect in 5s...",details:{}},...e.slice(0,199)]),setTimeout(c,5e3)},e.onerror=e=>{console.error("Logs WebSocket error:",e),a(!1),t(t=>[{timestamp:Date.now(),level:"ERROR",message:"Log WebSocket connection error.",details:{errorEvent:JSON.stringify(e,Object.getOwnPropertyNames(e))}},...t.slice(0,199)])}},[n]);return ee(()=>(c(),()=>{_.current&&_.current.close()}),[c]),ee(()=>{i&&s.current&&(s.current.scrollTop=s.current.scrollHeight)},[e,i]),U("div",{class:"tab-content-item",id:"logs-section-content",children:[U("h2",{children:"Real-time Logs"}),U("div",{class:"filter-bar",id:"logs-filter",children:[U("label",{for:"log-level-filter",children:"Min Level:"}),U("select",{id:"log-level-filter",value:n,onChange:e=>r(e.target.value),children:[U("option",{value:"all",children:"All"}),U("option",{value:"TRACE",children:"Trace"}),U("option",{value:"DEBUG",children:"Debug"}),U("option",{value:"INFO",children:"Info"}),U("option",{value:"WARN",children:"Warn"}),U("option",{value:"ERROR",children:"Error"}),U("option",{value:"FATAL",children:"Fatal"})]}),U("label",{for:"log-auto-scroll",children:"Auto-scroll:"}),U("input",{type:"checkbox",id:"log-auto-scroll",checked:i,onChange:e=>o(e.target.checked)}),U("span",{children:[" Status: ",l?"Connected":"Disconnected"]})]}),U("div",{id:"logs-content",class:"log-container",ref:s,children:e.map((e,t)=>{var n;return U("div",{class:`log-entry level-${e.level}`,children:[U("span",{class:"timestamp",children:new Date(e.timestamp).toLocaleTimeString("en-US",{hour12:!1})}),U("span",{class:"level",children:["[",e.level,"]"]}),U("span",{class:"message",children:null==(n=e.message)?"":n.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),e.details&&Object.keys(e.details).length>0&&U("details",{class:"log-details",children:[U("summary",{children:"Details"}),U("pre",{children:JSON.stringify(e.details,null,2)})]})]},t)}).reverse()})]})}function em(){return U("div",{class:"tab-content-item",id:"traces-section-content",children:[U("h2",{children:"MCP Traces"}),U("div",{class:"filter-bar",id:"trace-filter",children:[U("label",{for:"trace-auto-scroll",children:"Auto-scroll:"}),U("input",{type:"checkbox",id:"trace-auto-scroll",checked:!0})]}),U("div",{id:"traces-content",class:"log-container",children:U("p",{children:U("i",{children:"Connecting to traces..."})})})]})}function ev(){return U("div",{class:"tab-content-item",id:"agents-backends-section-content",children:[U("h2",{children:"Dynamic Agents & Backend Status"}),U("section",{id:"dynamic-agents-list",children:[U("h3",{children:"Dynamically Registered Agents (from AGENTS env var)"}),U("p",{children:U("i",{children:"Agent list will appear here if AGENTS environment variable is set."})})]}),U("section",{id:"backend-tools-status",children:[U("h3",{children:"Configured Backend Tools Status"}),U("p",{children:U("i",{children:"Backend tool statuses will appear here."})})]})]})}function ey(){let[e,t]=X([]),[n,r]=X(""),[i,o]=X(""),[l,a]=X([]),[s,_]=X(!1),[c,u]=X(null);ee(()=>{let e=(n=0)=>{fetch("/api/config-details").then(e=>e.ok?e.json():(console.error("ChatTab: API call to /api/config-details failed with status:",e.status),e.text().then(t=>{throw Error(`API error ${e.status}: ${t||"No error message"}`)}))).then(e=>{console.log("ChatTab: Received data from /api/config-details:",JSON.stringify(e,null,2));let n=[];if(e?.finalEffectiveConfig?.gptAgents&&Array.isArray(e.finalEffectiveConfig.gptAgents)&&e.finalEffectiveConfig.gptAgents.length>0?console.log("ChatTab: Using gptAgents from finalEffectiveConfig:",JSON.stringify(n=e.finalEffectiveConfig.gptAgents)):e?.initialEnvConfig?.gptAgents&&Array.isArray(e.initialEnvConfig.gptAgents)&&e.initialEnvConfig.gptAgents.length>0?console.log("ChatTab: Using gptAgents from initialEnvConfig:",JSON.stringify(n=e.initialEnvConfig.gptAgents)):(console.warn("ChatTab: No gptAgents array found or array is empty in both finalEffectiveConfig and initialEnvConfig."),e?.finalEffectiveConfig&&console.log("ChatTab: finalEffectiveConfig.gptAgents:",JSON.stringify(e.finalEffectiveConfig.gptAgents)),e?.initialEnvConfig&&console.log("ChatTab: initialEnvConfig.gptAgents:",JSON.stringify(e.initialEnvConfig.gptAgents))),n.length>0){u(null);let e=n.map(e=>{let t=e.replace(/[^a-zA-Z0-9_\/]/g,"_").replace(/\//g,"_");return{id:t,displayName:e,methodName:`agentify/agent_${t}`}});console.log("ChatTab: Processed availableAgents:",JSON.stringify(e)),t(e),e.length>0&&(r(e[0].methodName),console.log("ChatTab: Selected agent set to:",e[0].methodName))}else t([]),r(""),console.warn("ChatTab: agentsListToProcess is empty. Setting no agents.")}).catch(i=>{console.error("ChatTab: Error fetching or processing agent list:",i.message,i.stack),u(`Could not load agent list: ${i.message}`),t([]),r(""),n<2&&setTimeout(()=>e(n+1),1e3)})};e()},[]);let d=er(async()=>{if(!n||!i.trim()||0===e.length)return;let t=e.find(e=>e.methodName===n);if(!t){u("Selected agent details not found. Cannot send query."),_(!1);return}let r=t.displayName,l={sender:"user",text:i,timestamp:new Date};a(e=>[...e,l]),_(!0),u(null);try{o("");let e=await fetch("/api/chat-with-agent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({agentModelString:r,params:{query:i,context:null}})});if(!e.ok){let t=await e.json().catch(()=>({message:`HTTP error ${e.status}`}));throw Error(t.message||`Agent call failed with status ${e.status}`)}let t=await e.json(),n={sender:"agent",text:t.message||"No message from agent.",timestamp:new Date,data:t};a(e=>[...e,n])}catch(t){console.error("ChatTab: Error in handleSendQuery:",t),u(t.message||"Failed to get response from agent.");let e={sender:"agent",text:`Error: ${t.message||"Failed to get response"}`,timestamp:new Date};a(t=>[...t,e])}finally{_(!1)}},[n,i,e]);return U("div",{class:"tab-content-item",id:"chat-section-content",children:[U("h2",{children:"Chat with Agents"}),c&&U("pre",{class:"error-display",children:["Error: ",c]}),U("div",{class:"chat-controls filter-bar",children:[U("label",{for:"agent-select",children:"Select Agent:"}),U("select",{id:"agent-select",value:n,onChange:e=>r(e.target.value),disabled:0===e.length||s,children:[0===e.length&&U("option",{value:"",children:"No agents available (set AGENTS env var)"}),e.map(e=>U("option",{value:e.methodName,children:e.displayName},e.id))]})]}),U("div",{class:"chat-history",children:[l.map((e,t)=>U("div",{class:`chat-message msg-${e.sender}`,children:[U("span",{class:"timestamp",children:e.timestamp.toLocaleTimeString()}),U("strong",{class:"sender",children:["user"===e.sender?"You":"Agent",":"]}),U("p",{class:"text",children:e.text}),e.data&&U("details",{children:[U("summary",{children:"Raw Response Data"}),U("pre",{children:JSON.stringify(e.data,null,2)})]})]},t)),s&&U("div",{class:"chat-message msg-system",children:U("em",{children:"Agent is thinking..."})})]}),U("div",{class:"chat-input-area",children:[U("textarea",{id:"chat-query-input",value:i,onInput:e=>o(e.target.value),placeholder:"Enter your query...",disabled:s||0===e.length}),U("button",{type:"button",onClick:d,disabled:s||!i.trim()||0===e.length||!n,children:"Send"})]})]})}const eb=document.getElementById("app");eb?(e=U(function(){let[e,t]=X("loading...");ee(()=>{fetch("/api/gateway-version").then(e=>e.ok?e.json():Promise.reject("Failed to fetch version")).then(e=>{e&&e.version?t(e.version):t("N/A")}).catch(e=>{console.error("Error fetching gateway version:",e),t("Error")})},[]);let n=[{id:"status",name:"Status & Config",content:U(ed,{})},{id:"configDetails",name:"Config Details",content:U(eh,{})},{id:"agentsBackends",name:"Agents & Backends",content:U(ev,{})},{id:"chat",name:"Chat with Agents",content:U(ey,{})},{id:"logs",name:"Logs",content:U(eg,{})},{id:"traces",name:"Traces",content:U(em,{})}];return U("div",{class:"app-container",children:[" ",U("header",{children:U("h1",{children:"MCP Agentify - Control Panel"})}),U("main",{children:U(eu,{tabs:n})}),U("footer",{children:U("p",{children:["MCP Agentify Status: ",U("span",{id:"footer-status",children:"UI Loaded"})," | Version: ",U("span",{id:"gateway-version",children:e})]})})]})},{}),(t=eb)==document&&(t=document.documentElement),a.__&&a.__(e,t),r=n&&n.__k||t.__k,i=[],o=[],R(t,e=(n||t).__k=function(e,t,n){var r,i,o,a={};for(o in t)"key"==o?r=t[o]:"ref"==o?i=t[o]:a[o]=t[o];if(arguments.length>2&&(a.children=arguments.length>3?l.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)null==a[o]&&(a[o]=e.defaultProps[o]);return E(e,a,r,i,null)}(C,null,[e]),r||m,m,t.namespaceURI,n?[n]:r?null:t.firstChild?l.call(t.childNodes):null,i,n?n:r?r.__e:t.firstChild,!1,o),D(i,e,o)):console.error("Application root element '#app' not found.");
//# sourceMappingURL=frontend.958352a0.js.map
